resources:
  - name: every-two-minutes
    type: time
    source:
      interval: 2m

  - name: gds-techops-gameday-git
    type: git
    source:
      uri: git@github.com:tlwr/gds-techops-gameday.git
      branch: wip-tlwr
      private_key: ((read_only_ssh_private_key))

jobs:
  - name: 01-smoke
    serial: true
    plan:
      - get: every-two-minutes
        trigger: true

      - get: gds-techops-gameday-git

      - task: smoke
        config: &smoke-config
          params:
            APP_URL: https://one.game.gds-reliability.engineering
            IDENTIFIER: gameday-one

          platform: linux
          image_resource:
            type: docker-image
            source:
              repository: ruby
              tag: '2.6'

          run:
            path: ruby
            dir: gds-techops-gameday-git
            args: ['scripts/smoke-01.rb']

  - name: 02-smoke
    serial: true
    plan:
      - get: every-two-minutes
        trigger: true

      - get: gds-techops-gameday-git

      - task: smoke
        config:
          <<: *smoke-config
          params:
            APP_URL: https://two.game.gds-reliability.engineering
            IDENTIFIER: gameday-two

  - name: 03-smoke
    serial: true
    plan:
      - get: every-two-minutes
        trigger: true

      - get: gds-techops-gameday-git

      - task: smoke
        config:
          <<: *smoke-config
          params:
            APP_URL: https://three.game.gds-reliability.engineering
            IDENTIFIER: gameday-three

  - name: 04-smoke
    serial: true
    plan:
      - get: every-two-minutes
        trigger: true

      - get: gds-techops-gameday-git

      - task: smoke
        config:
          <<: *smoke-config
          params:
            APP_URL: https://four.game.gds-reliability.engineering
            IDENTIFIER: gameday-four

  - name: 05-smoke
    serial: true
    plan:
      - get: every-two-minutes
        trigger: true

      - get: gds-techops-gameday-git

      - task: smoke
        config:
          <<: *smoke-config
          params:
            APP_URL: https://five.game.gds-reliability.engineering
            IDENTIFIER: gameday-five

  - name: 06-smoke
    serial: true
    plan:
      - get: every-two-minutes
        trigger: true

      - get: gds-techops-gameday-git

      - task: smoke
        config:
          <<: *smoke-config
          params:
            APP_URL: https://six.game.gds-reliability.engineering
            IDENTIFIER: gameday-six

  - name: 07-smoke
    serial: true
    plan:
      - get: every-two-minutes
        trigger: true

      - get: gds-techops-gameday-git

      - task: smoke
        config:
          <<: *smoke-config
          params:
            APP_URL: https://seven.game.gds-reliability.engineering
            IDENTIFIER: gameday-seven
